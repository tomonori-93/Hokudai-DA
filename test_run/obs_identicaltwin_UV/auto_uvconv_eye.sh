#!/usr/bin/bash
EXE=~/usr/local/CL_intel/bin/ruby
EXE2=pseudo_H08UV_model
SCRIPT=dcl_nml_change.rb
NAMELIST=pseudo_H08UV_model_eye_dx6km.nml
VNAME=( ininame r_out )
export F_UFMTENDIAN="little:11"
ulimit -s unlimited
export OMP_NUM_THREADS=1
export OMP_STACKSIZE=512000
TIME=( 000000 003600 007200 010800 014400 018000 021600 025200 028800 032400 036000 039600 043200 046800 050400 054000 057600 061200 064800 068400 072000 075600 079200 082800 086400 090000 093600 097200 100800 104400 108000 111600 115200 118800 122400 126000 129600 133200 136800 140400 144000 147600 151200 154800 158400 162000 165600 169200 172800 )
RADOUT=( 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 40.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 60.0e3 )

for i in ${!TIME[@]}
do
   ${EXE} ${SCRIPT} ${NAMELIST} ${VNAME[0]} ${TIME[$i]}
   ${EXE} ${SCRIPT} ${NAMELIST} ${VNAME[1]} ${RADOUT[$i]}
   ./${EXE2} < ${NAMELIST} &
   sleep 3
   #grep "${VNAME[0]}" ${NAMELIST}  # For monitor
   #grep "${VNAME[1]}" ${NAMELIST}  # For monitor
done
